# 异步任务线程与异步任务线程池

## 构造函数
### ```AsyncThread()```
构造异步任务线程对象
### ```AsyncThreadPool(std::size_t count)```
构造异步任务线程池对象
参数：  
```count```：线程池所具有的线程数，若赋值为0，则为1个线程
## 成员函数
异步任务线程对象与异步任务线程池对象的成员函数完全相同
### ```push```
函数原型：
```C++
void push(void*(*func)(void*),void* args,const std::string& iden);
```
参数：  
```func```：要异步执行的可调用对象的泛型包装器  
```args```：泛型包装器的参数，若无可空也可赋值为 nullptr  
```iden```：泛型包装器返回值名称，它将作为返回值寻找的依据，若无可空也可赋值为""(空字符串)  
*注：*  
*异步任务线程池对象调用push函数时，会将push的任务添加至所管理的异步任务线程对象中剩余任务数最少的对象*
*若需要接受返回值，指定的iden不应当重复，若重复，会抛出异常(const char\*)*

### ```getret```
函数原型：
```C++
void* getret(const std::string& iden);
```
参数：
```iden```：```push```函数指定的查找依据
*注：*  
*若调用时结果尚未产生，将会引发代码阻塞*  
*若所给iden不存在于现有返回值表，将会抛出异常(const char\*)*  
*调用该函数获取一次指定iden对应的返回值后，该iden将会被移除*

## 原理
通过运行时泛型(```void*```)使所有的变量、函数类型归一化  
异步任务线程(```AsyncThread```)通过异步任务队列存储异步任务(包括可调用对象泛型包装器```void*(*)(void*)```、参数列表泛型包装器(```void*```)、返回值名(```std::string```))，通过泛型返回值映射表(```std::map<std::string,void*>```)存储有返回值的可调用对象泛型包装器产生的返回值  
每个异步任务线程对象都与一个独立的线程所绑定，该线程会不断检查异步任务队列是否为空，若不为空，则执行队列中的任务  
线程检查队列是否为空由```silence_duration```所指定，默认为300毫秒  
异步任务线程池(```AsyncThreadPool```)则为管理数个异步任务线程对象，它依据每个异步任务线程对象剩余任务数决定```push```会将任务添加至哪个异步任务队列

## 使用
|-test
    |-test.cpp  使用示例及说明
    |-test.exe
    |-test.txt